import{c as T}from"./chunk-M665TXEG.js";import{a as S}from"./chunk-XZ4AHYFY.js";import{Da as h,Ea as x,Ga as r,Ha as b,Ia as g,Ja as k,Ka as U,La as E,Ma as y,S as u,T as p,Va as I,Wa as V,Xa as P,Ya as L,ga as c,ja as w,na as v,pa as f,xa as m,ya as _,za as d}from"./chunk-A6SYY6XR.js";var F=o=>({"text-center":o});function O(o,i){if(o&1&&(_(0,"th",11),g(1),d()),o&2){let e=i.$implicit,t=i.index;m("ngClass",y(2,F,t===0)),c(),k(e)}}function R(o,i){if(o&1){let e=h();_(0,"span",12),x("click",function(n){u(e);let s=r().index,a=r().index,l=r();return p(l.startEdit(a,s,n))}),g(1),d()}if(o&2){let e=r().$implicit,t=r().$implicit;c(),U(" ",t[e.toLowerCase()]," ")}}function M(o,i){if(o&1){let e=h();_(0,"div",17)(1,"input",18,0),x("input",function(n){u(e);let s=r().index,a=r().index,l=r();return p(l.onCellInput(a,s,n))})("keydown.enter",function(n){u(e);let s=r().index,a=r().index,l=r();return p(l.saveCellEdit(a,s,n))})("keydown.esc",function(n){u(e);let s=r(3);return p(s.cancelEdit(n))})("click",function(n){return u(e),p(n.stopPropagation())}),d(),_(3,"button",19),x("click",function(n){u(e);let s=r().index,a=r().index,l=r();return p(l.saveCellEdit(a,s,n))}),g(4," \u2713 "),d(),_(5,"button",20),x("click",function(n){u(e);let s=r(3);return p(s.cancelEdit(n))}),g(6," \u2715 "),d()()}if(o&2){let e=r(),t=e.$implicit,n=e.index,s=r(),a=s.$implicit,l=s.index,C=r();c(),m("value",C.tempValues[l+"-"+n]||a[t.toLowerCase()])}}function N(o,i){if(o&1){let e=h();_(0,"input",21),x("input",function(n){u(e);let s=r().index,a=r().index,l=r();return p(l.onCellInput(a,s,n))})("keydown.enter",function(n){return u(e),p(n.preventDefault())})("keydown.esc",function(n){u(e);let s=r(3);return p(s.cancelEdit(n))})("click",function(n){return u(e),p(n.stopPropagation())}),d()}if(o&2){let e=r(),t=e.$implicit,n=e.index,s=r(),a=s.$implicit,l=s.index,C=r();m("value",C.tempValues[l+"-"+n]||a[t.toLowerCase()])}}function j(o,i){if(o&1&&(_(0,"td"),f(1,R,2,1,"span",14)(2,M,7,1,"div",15)(3,N,1,1,"input",16),d()),o&2){let e=i.index,t=r().index,n=r();c(),m("ngIf",!n.isCellEditing(t,e)&&!n.isRowEditing(t)),c(),m("ngIf",n.isCellEditing(t,e)),c(),m("ngIf",!n.isCellEditing(t,e)&&n.isRowEditing(t))}}function z(o,i){if(o&1){let e=h();_(0,"tr",12),x("click",function(n){let s=u(e).$implicit,a=r();return p(a.onRowClick(s,n))}),f(1,j,4,3,"td",13),d()}if(o&2){let e=r();c(),m("ngForOf",e.headers)}}var $=class o{constructor(i,e){this.usersService=i;this.router=e}users=[];headers=[];currentPage=1;pageSize=5;editing=null;tempValues={};isCellEditing(i,e){return!!(this.editing&&this.editing.row===i&&"col"in this.editing&&this.editing.col===e)}isRowEditing(i){return!!(this.editing&&this.editing.row===i&&"all"in this.editing&&this.editing.all)}get totalPages(){return Math.ceil(this.users.length/this.pageSize)}get paginatedUsers(){let i=(this.currentPage-1)*this.pageSize;return this.users.slice(i,i+this.pageSize)}startEdit(i,e,t){t.stopPropagation(),this.editing={row:i,col:e};let n=this.headers[e].toLowerCase();this.tempValues[`${i}-${e}`]=this.paginatedUsers[i][n]}startEditRow(i,e){e.stopPropagation(),this.editing={row:i,all:!0},this.headers.forEach((t,n)=>{let s=t.toLowerCase();this.tempValues[`${i}-${n}`]=this.paginatedUsers[i][s]})}onCellInput(i,e,t){this.tempValues[`${i}-${e}`]=t.target.value}saveCellEdit(i,e,t){t.stopPropagation(),this.updateCell(i,e,this.tempValues[`${i}-${e}`]),this.stopEdit()}saveRow(i,e){e.stopPropagation(),this.headers.forEach((t,n)=>{let s=`${i}-${n}`;this.tempValues.hasOwnProperty(s)&&this.updateCell(i,n,this.tempValues[s])}),this.stopEdit()}cancelEdit(i){i.stopPropagation(),this.stopEdit()}onRowClick(i,e){this.editing||this.selectedUser(i)}stopEdit(){this.editing=null,this.tempValues={}}updateCell(i,e,t){let n=this.headers[e].toLowerCase();this.paginatedUsers[i][n]=t;let s=this.paginatedUsers[i].id,a=this.users.findIndex(l=>l.id===s);a!==-1&&(this.users[a][n]=t)}ngOnInit(){this.usersService.getUsers().subscribe(i=>{this.users=i,this.headers=Object.keys(i[0]||{}).map(e=>e.charAt(0).toUpperCase()+e.slice(1))})}goToPage(i){i>=1&&i<=this.totalPages&&(this.currentPage=i)}trackByUserId(i,e){return e.id}selectedUser(i,e){this.router.navigate(["/home/user-details",i.id],{state:{user:i}}),e&&e.stopPropagation()}static \u0275fac=function(e){return new(e||o)(w(S),w(T))};static \u0275cmp=v({type:o,selectors:[["app-users-list"]],decls:18,vars:11,consts:[["cellInput",""],[1,"col-lg-12"],[1,"table","table-bordered","table-striped","table-hover","table-responsive","scrollable"],[3,"ngClass",4,"ngFor","ngForOf"],[3,"click",4,"ngFor","ngForOf","ngForTrackBy"],["aria-label","User list pagination",2,"margin-top","16px"],[1,"pagination","justify-content-center"],[1,"page-item"],[1,"page-link",3,"click","disabled"],[1,"page-item","disabled"],[1,"page-link"],[3,"ngClass"],[3,"click"],[4,"ngFor","ngForOf"],[3,"click",4,"ngIf"],["class","d-flex align-items-center",4,"ngIf"],["class","form-control form-control-sm",3,"value","input","keydown.enter","keydown.esc","click",4,"ngIf"],[1,"d-flex","align-items-center"],["autofocus","",1,"form-control","form-control-sm","me-2",3,"input","keydown.enter","keydown.esc","click","value"],[1,"btn","btn-sm","btn-success","me-1",3,"click"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"form-control","form-control-sm",3,"input","keydown.enter","keydown.esc","click","value"]],template:function(e,t){e&1&&(_(0,"div",1)(1,"table",2)(2,"thead")(3,"tr"),f(4,O,2,4,"th",3),d()(),_(5,"tbody"),f(6,z,2,1,"tr",4),d()(),_(7,"nav",5)(8,"ul",6)(9,"li",7)(10,"button",8),x("click",function(){return t.goToPage(t.currentPage-1)}),g(11,"Prev"),d()(),_(12,"li",9)(13,"span",10),g(14),d()(),_(15,"li",7)(16,"button",8),x("click",function(){return t.goToPage(t.currentPage+1)}),g(17,"Next"),d()()()()()),e&2&&(c(4),m("ngForOf",t.headers),c(2),m("ngForOf",t.paginatedUsers)("ngForTrackBy",t.trackByUserId),c(3),b("disabled",t.currentPage===1),c(),m("disabled",t.currentPage===1),c(4),E("Page ",t.currentPage," of ",t.totalPages),c(),b("disabled",t.currentPage===t.totalPages),c(),m("disabled",t.currentPage===t.totalPages))},dependencies:[L,I,V,P],encapsulation:2})};export{$ as UsersList};
